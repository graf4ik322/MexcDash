# FIFO –†–∞—Å—á–µ—Ç P&L –¥–ª—è Grid Trading

## –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞

### üéØ –ü—Ä–∏–Ω—Ü–∏–ø FIFO (First In, First Out)
- –ö–∞–∂–¥–∞—è –ø–æ–∫—É–ø–∫–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å
- –ü—Ä–∏ –ø—Ä–æ–¥–∞–∂–µ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è —Å–∞–º—ã–µ —Å—Ç–∞—Ä—ã–µ –ø–æ–∫—É–ø–∫–∏
- –û–±—ä–µ–º –ø—Ä–æ–¥–∞–∂–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å –æ–±—ä–µ–º–æ–º –ø–æ–∫—É–ø–æ–∫ –ø–æ –ø–æ—Ä—è–¥–∫—É

### üìä –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

#### 1. –ü–æ–∫—É–ø–∫–∞ (Buy)
```javascript
// –î–æ–±–∞–≤–ª—è–µ–º –≤ FIFO –æ—á–µ—Ä–µ–¥—å
buyQueue.push({
    amount: amount,    // –û–±—ä–µ–º –ø–æ–∫—É–ø–∫–∏
    cost: total,       // –°—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ–∫—É–ø–∫–∏
    price: price       // –¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏
});
```

#### 2. –ü—Ä–æ–¥–∞–∂–∞ (Sell)
```javascript
// –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –ø—Ä–æ–¥–∞–∂—É –ø—Ä–æ—Ç–∏–≤ –æ—á–µ—Ä–µ–¥–∏ –ø–æ–∫—É–ø–æ–∫
while (remainingSellAmount > 0 && buyQueue.length > 0) {
    const buyOrder = buyQueue[0]; // –ë–µ—Ä–µ–º —Å–∞–º—É—é —Å—Ç–∞—Ä—É—é –ø–æ–∫—É–ø–∫—É
    
    if (buyOrder.amount <= remainingSellAmount) {
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤—Å—é –ø–æ–∫—É–ø–∫—É
        totalBuyCost += buyOrder.cost;
        buyQueue.shift(); // –£–¥–∞–ª—è–µ–º –∏–∑ –æ—á–µ—Ä–µ–¥–∏
    } else {
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º —á–∞—Å—Ç—å –ø–æ–∫—É–ø–∫–∏
        const usedRatio = remainingSellAmount / buyOrder.amount;
        totalBuyCost += buyOrder.cost * usedRatio;
        buyOrder.amount -= remainingSellAmount;
    }
}

// –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–∏–±—ã–ª—å
const realizedPnL = sellValue - totalBuyCost - fees;
```

### üîÑ –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã:

#### –î–µ–Ω—å 1: –ü–æ–∫—É–ø–∫–∏
- BTC: 0.1 –ø–æ $50,000 = $5,000
- BTC: 0.05 –ø–æ $49,000 = $2,450

**–û—á–µ—Ä–µ–¥—å –ø–æ–∫—É–ø–æ–∫:**
```
[0.1 BTC @ $50,000, 0.05 BTC @ $49,000]
```

#### –î–µ–Ω—å 2: –ü—Ä–æ–¥–∞–∂–∞
- BTC: 0.12 –ø–æ $51,000 = $6,120

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–¥–∞–∂–∏:**
1. –ë–µ—Ä–µ–º 0.1 BTC @ $50,000 = $5,000
2. –ë–µ—Ä–µ–º 0.02 BTC @ $49,000 = $980
3. **–ü—Ä–∏–±—ã–ª—å = $6,120 - $5,980 - –∫–æ–º–∏—Å—Å–∏–∏**

### ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

1. **–¢–æ—á–Ω–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ** - –∫–∞–∂–¥–∞—è –ø—Ä–æ–¥–∞–∂–∞ —Å–≤—è–∑–∞–Ω–∞ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –ø–æ–∫—É–ø–∫–∞–º–∏
2. **–†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ü–µ–Ω—ã –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
3. **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π P&L** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—É—é –ø—Ä–∏–±—ã–ª—å/—É–±—ã—Ç–æ–∫
4. **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —á–∞—Å—Ç–∏—á–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥—Ä–æ–±–Ω—ã–µ –æ–±—ä–µ–º—ã

### üéõÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏:

- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: –†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (FIFO)
- **–ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å**: –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–∏–±—ã–ª—å (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞)

### üìà –†–µ–∑—É–ª—å—Ç–∞—Ç:

–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç **—Ä–µ–∞–ª—å–Ω—É—é –ø—Ä–∏–±—ã–ª—å** –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö —Å–¥–µ–ª–æ–∫, –∞ –Ω–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º—É—é –∏–ª–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é!